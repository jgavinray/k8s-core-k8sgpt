# Default values for k8sgpt-deployment
# This chart wraps the official k8sgpt-operator chart

# Enable/disable the k8sgpt-operator dependency
k8sgpt-operator:
  enabled: true
  
  # Override default values for the k8sgpt-operator chart
  # See https://github.com/k8sgpt-ai/k8sgpt-operator for full list of options
  
  # Namespace configuration
  namespace:
    create: true
    name: k8sgpt-operator-system

# K8sGPT Custom Resource configuration
# This will be deployed after the operator is installed
k8sgpt:
  enabled: true
  name: k8sgpt
  namespace: k8sgpt-operator-system
  
  # AI Provider Configuration
  ai:
    enabled: true
    # Options: openai, azureopenai, localai, amazonbedrock, google, cohere
    # Note: For Ollama, use backend: openai with baseUrl pointing to Ollama's OpenAI-compatible endpoint
    # The k8sgpt CRD does not support 'ollama' as a backend value
    backend: openai

    # Model to use
    # For OpenAI: gpt-4o-mini, gpt-3.5-turbo, gpt-4, gpt-4-turbo
    # For Ollama: llama2, mistral, codellama, or custom models (e.g., gpt-oss:120b)
    model: gpt-oss:120b

    # Base URL for external AI servers (Ollama, LocalAI)
    # For Ollama: "http://your-ollama-server:11434/v1" (NO trailing slash)
    # For LocalAI: "http://your-localai-server:8080/v1"
    # Leave empty for cloud providers (OpenAI, Azure OpenAI, etc.)
    # IMPORTANT: Remove trailing slash from URL to avoid API path construction issues
    baseUrl: "http://192.168.0.33:11434/v1"

    # Secret configuration for API key
    secret:
      name: k8sgpt-secret
      key: openai-api-key
      # Set this to true if you want the chart to create the secret
      # You'll need to provide the API key value
      create: true
      # API key value (only used if create: true)
      # WARNING: In production, use external secret management!
      apiKey: ""

    # Auto-Remediation Configuration
    # WARNING: Auto-remediation will automatically attempt to fix detected issues in your cluster
    # DISABLED by default for safety - only enable in non-production environments or after thorough testing
    autoRemediation:
      enabled: false
      # Resource types that are eligible for auto-remediation
      # Options: Pod, Deployment, Service, Ingress
      resources:
        - Pod
        - Deployment
        - Service
        - Ingress
  
  # Version of k8sgpt to deploy
  version: v0.3.41
  
  # Disable caching
  noCache: false
  
  # Analysis interval (time between analysis runs)
  # Format: ^[0-9]+[smh]$ (e.g., "30s", "5m", "1h")
  analysis:
    interval: "30s"
  
  # External Secret configuration for API service token
  # Uses External Secrets Operator to sync secrets from external secret stores
  externalSecret:
    enabled: false
    name: k8sgpt-api-token-secret
    # SecretStore name (must exist in cluster)
    secretStoreRef:
      name: ""
      kind: SecretStore  # or ClusterSecretStore
    # Remote secret key/path in external store
    remoteRef:
      key: ""
      property: ""  # Optional: specific property within the key
    # Target secret configuration
    target:
      name: k8sgpt-api-token
      namespace: k8sgpt-operator-system
      creationPolicy: Owner
      type: Opaque
    # Secret data mapping
    data:
      - secretKey: api-token
        remoteRef:
          key: ""
          property: ""
  
  # Additional configuration
  # See https://docs.k8sgpt.ai/reference/operator/overview/ for more options

# Cleanup configuration
# Controls automatic cleanup of resources during helm uninstall
cleanup:
  # Enable cleanup job on helm uninstall
  enabled: true
  # Delete all K8sGPT custom resources before uninstalling
  deleteCRs: true
  # Delete CRDs (WARNING: This will delete ALL k8sgpt CRDs from the cluster)
  # Set to false in production environments with shared CRDs
  deleteCRDs: true


